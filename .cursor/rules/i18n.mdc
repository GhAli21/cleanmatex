# Internationalization (i18n) and RTL

** Always add new messages keys into en.json and ar.json**

** when adding to translation files such as en.json, ar.json first search if already exist and reuse**

## Before Adding Keys
- Search `messages/en.json` and `messages/ar.json` for existing keys; reuse when possible
- Use `tCommon` for: save, cancel, delete, edit, create, update, search, filter, clearFilters, loading, error, success, actions, status, date, etc.
- Key naming: camelCase, concise; avoid long key names
- Parity: Always update both en.json and ar.json; run `npm run check:i18n` before committing
- Pluralization: Prefer ICU format `{count, plural, one {...} other {...}}` over manual plural keys (*Plural)
- Reference: [docs/dev/i18n_docs/style-guide.md](../docs/dev/i18n_docs/style-guide.md)

## Backend
Store EN/AR fields and return both.

## Frontend
- next-intl provider and locale-aware `<html dir>`
- Tailwind RTL utilities for spacing, alignment, and icon direction
- Test Arabic screens, forms, tables, and navigation


---

## ğŸŒ INTERNATIONALIZATION STRATEGY

### Languages Supported
- **English** (en) - Default
- **Arabic** (ar) - RTL support required

---

## Backend Strategy

### Database Bilingual Pattern
Store both languages in the database:

```sql
-- Example table with bilingual fields
CREATE TABLE org_services_mst (
  id UUID PRIMARY KEY,
  tenant_org_id UUID NOT NULL,
  
  -- Bilingual fields
  service_name VARCHAR(250),       -- English
  service_name2 VARCHAR(250),      -- Arabic
  description TEXT,                 -- English  
  description2 TEXT,                -- Arabic
  
  -- Pricing
  base_price DECIMAL(10,2)
);
```

### API Response Pattern
Return both languages in responses:

```json
{
  "id": "uuid",
  "name": "Wash & Iron",
  "nameAr": "ØºØ³ÙŠÙ„ ÙˆÙƒÙˆÙŠ",
  "description": "Professional wash and iron service",
  "descriptionAr": "Ø®Ø¯Ù…Ø© Ø§Ù„ØºØ³ÙŠÙ„ ÙˆØ§Ù„ÙƒÙˆÙŠ Ø§Ù„Ø§Ø­ØªØ±Ø§ÙÙŠØ©",
  "price": 2.500
}
```

---

## Frontend Setup (Next.js)

### Install and Configure next-intl
```bash
npm install next-intl
```

### App Router Structure
```
app/
â”œâ”€â”€ [locale]/
â”‚   â”œâ”€â”€ layout.tsx       # Locale wrapper
â”‚   â”œâ”€â”€ page.tsx         # Home page
â”‚   â””â”€â”€ (dashboard)/
â”‚       â”œâ”€â”€ orders/
â”‚       â””â”€â”€ customers/
```

### Locale Layout
```typescript
// app/[locale]/layout.tsx
import { NextIntlClientProvider } from 'next-intl';
import { getMessages } from 'next-intl/server';

export default async function LocaleLayout({ 
  children, 
  params: { locale } 
}) {
  const messages = await getMessages();
  
  return (
    <html lang={locale} dir={locale === 'ar' ? 'rtl' : 'ltr'}>
      <body>
        <NextIntlClientProvider messages={messages}>
          {children}
        </NextIntlClientProvider>
      </body>
    </html>
  );
}
```

### Translation Files
```
messages/
â”œâ”€â”€ en.json
â””â”€â”€ ar.json
```

Example translation structure:
```json
// messages/en.json
{
  "common": {
    "save": "Save",
    "cancel": "Cancel",
    "delete": "Delete",
    "edit": "Edit",
    "search": "Search",
    "loading": "Loading..."
  },
  "orders": {
    "title": "Orders",
    "new": "New Order",
    "status": {
      "pending": "Pending",
      "processing": "Processing",
      "ready": "Ready",
      "delivered": "Delivered"
    }
  },
  "customers": {
    "title": "Customers",
    "addNew": "Add New Customer",
    "phone": "Phone Number",
    "name": "Customer Name"
  }
}

// messages/ar.json
{
  "common": {
    "save": "Ø­ÙØ¸",
    "cancel": "Ø¥Ù„ØºØ§Ø¡",
    "delete": "Ø­Ø°Ù",
    "edit": "ØªØ¹Ø¯ÙŠÙ„",
    "search": "Ø¨Ø­Ø«",
    "loading": "Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù…ÙŠÙ„..."
  },
  "orders": {
    "title": "Ø§Ù„Ø·Ù„Ø¨Ø§Øª",
    "new": "Ø·Ù„Ø¨ Ø¬Ø¯ÙŠØ¯",
    "status": {
      "pending": "Ù‚ÙŠØ¯ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±",
      "processing": "Ù‚ÙŠØ¯ Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©",
      "ready": "Ø¬Ø§Ù‡Ø²",
      "delivered": "ØªÙ… Ø§Ù„ØªØ³Ù„ÙŠÙ…"
    }
  }
}
```

### Using Translations in Components
Always Re-Use Keys If Possible
For Common Keys use tCommon()

```typescript
import { useTranslations } from 'next-intl';

export default function OrdersPage() {
  const tCommon = useTranslations('common');
  const t = useTranslations('orders');
  
  return (
    <div>
      <h1>{t('title')}</h1>
      <button>{tCommon('new')}</button>
    </div>
  );
}
```

---

## RTL (Right-to-Left) Support

### Tailwind CSS RTL Classes
```tsx
// Direction-aware spacing
<div className="ml-4 rtl:ml-0 rtl:mr-4">
  Content
</div>

// Direction-aware alignment
<div className="text-left rtl:text-right">
  Text
</div>

// Direction-aware flexbox
<div className="flex flex-row rtl:flex-row-reverse">
  <span>Item 1</span>
  <span>Item 2</span>
</div>

// Direction-aware borders
<div className="border-l-4 rtl:border-l-0 rtl:border-r-4">
  Content
</div>
```

### Direction-Aware Icons
```tsx
import { ChevronRight, ChevronLeft } from 'lucide-react';

// Automatic icon flipping
<ChevronRight className="rtl:rotate-180" />

// Or use conditional rendering
{locale === 'ar' ? <ChevronLeft /> : <ChevronRight />}
```

---

## Date & Time Formatting

```typescript
import { useLocale } from 'next-intl';

function formatDate(date: Date): string {
  const locale = useLocale();
  
  return new Intl.DateTimeFormat(locale === 'ar' ? 'ar-OM' : 'en-OM', {
    year: 'numeric',
    month: 'long',
    day: 'numeric'
  }).format(date);
}

function formatCurrency(amount: number): string {
  const locale = useLocale();
  
  return new Intl.NumberFormat(locale === 'ar' ? 'ar-OM' : 'en-OM', {
    style: 'currency',
    currency: 'OMR'
  }).format(amount);
}
```

---

## Language Switcher Component

```tsx
'use client';

import { useLocale } from 'next-intl';
import { useRouter, usePathname } from 'next/navigation';

export function LanguageSwitcher() {
  const locale = useLocale();
  const router = useRouter();
  const pathname = usePathname();
  
  const switchLanguage = () => {
    const newLocale = locale === 'en' ? 'ar' : 'en';
    const newPath = pathname.replace(`/${locale}`, `/${newLocale}`);
    router.push(newPath);
  };
  
  return (
    <button
      onClick={switchLanguage}
      className="px-4 py-2 bg-blue-500 text-white rounded"
    >
      {locale === 'en' ? 'Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©' : 'English'}
    </button>
  );
}
```

---

## Testing Checklist for RTL

- [ ] All text aligns correctly in Arabic
- [ ] Forms flow right-to-left
- [ ] Tables display correctly
- [ ] Navigation menus appear on correct side
- [ ] Icons face correct direction
- [ ] Modals and dropdowns position correctly
- [ ] Charts and graphs display properly
- [ ] Print layouts work in both directions

---

## Font Setup for Arabic

```css
/* app/globals.css */
@import url('https://fonts.googleapis.com/css2?family=Noto+Sans+Arabic:wght@400;500;600;700&display=swap');

body[dir="rtl"] {
  font-family: 'Noto Sans Arabic', sans-serif;
}
```

---

## Return to [Main Documentation](../CLAUDE.md)
